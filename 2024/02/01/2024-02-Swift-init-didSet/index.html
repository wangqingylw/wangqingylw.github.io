<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="Objective-C,didSet,SIL,ChatGPT">
  <meta name="description" content="é’ˆå¯¹ Swift å¼€å‘ç»ˆäºåˆ°çš„æ„é€ å‡½æ•°ä¸­æ˜¯å¦è§¦å‘å±æ€§è§‚å¯Ÿå™¨(didSet)é—®é¢˜è¿›è¡Œæ·±å…¥åˆ†æ">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Swiftæ„é€ å‡½æ•°(init)ä¸å±æ€§è§‚å¯Ÿå™¨(didSet) | ckqing.home</title>
  
  <link rel="icon" href="/assets/favicon.jpg">
  
  
  
  <!--link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css"-->
  
<link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css">

  
<link rel="stylesheet" href="/css/style.css">


  <!-- Gitalk -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <script defer src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" id="gitalk-script"></script>
  

  

  
  <!-- Goole Ad -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3859880292446330" crossorigin="anonymous"></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-43E779BM0G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-43E779BM0G');
  </script>
  

  <!-- mermaid -->
  
    <script src="https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js"></script>
    <script>
    if (window.mermaid) {
      mermaid.initialize({"startOnload":true,"theme":"default"});
    }
    </script>
  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
<div class="Shell">
    <aside class='SideBar'>
    <section class='avatar' style="background-image: url()">
        <div class='av-pic' style="background-image: url(/assets/avatar.jpg); background-repeat: no-repeat; background-size: cover">
        </div>
    </section>
    <section class='menu'>
        <div>ckqing.home</div>
        
        
            <div>Wang Qing</div>
        
        <ul>
          
            <li class="Btn">
                <a href="/">Home</a>
            </li>
          
            <li class="Btn">
                <a href="/archives/">Archive</a>
            </li>
          
            <li class="Btn">
                <a href="/tags/">Tags</a>
            </li>
          
            <li class="Btn">
                <a href="/categories/">Categories</a>
            </li>
          
            <li class="Btn">
                <a href="/about/">About</a>
            </li>
          
        </ul>
    </section>
    <section class="media">
        
            
                <a href="mailto:wq.cyan@gmail.com" aria-label="mailto:wq.cyan@gmail.com">
                    <img src="/assets/email.svg" alt="email" />
                </a>
            
        
            
                <a target="_blank" rel="noopener" href="https://www.youtube.com/channel/UCbxLA23tNs25YXY9jZJgq2w" aria-label="https://www.youtube.com/channel/UCbxLA23tNs25YXY9jZJgq2w">
                    <img src="/assets/youtube.svg" alt="youtube" />
                </a>
            
        
            
                <a target="_blank" rel="noopener" href="https://space.bilibili.com/4380662" aria-label="https://space.bilibili.com/4380662">
                    <img src="/assets/bilibili.svg" alt="bilibili" />
                </a>
            
        
    </section>
</aside>

    <div class="container">
        <div data-pager-shell>
            <div>
  <article class='ContentView'>
    <header class='PageTitle'>
        <h1>Swiftæ„é€ å‡½æ•°(init)ä¸å±æ€§è§‚å¯Ÿå™¨(didSet)</h1>
    </header>
    <div class='ListMeta'>
  <time datetime="2024-02-01T07:59:28.000Z" itemprop="datePublished">
    2024-02-01
  </time>
  
  | 
  <ul>
    
  <li class="meta-text">
  { <a href="/tags/iOS/">iOS</a> }
  </li>

  <li class="meta-text">
  { <a href="/tags/Swift/">Swift</a> }
  </li>


  </ul>
  
  
  / 
  <ul>
    
  <li class="meta-text">
  { <a href="/categories/tech/">tech</a> }
  </li>

  <li class="meta-text">
  { <a href="/categories/tech/iOS/">iOS</a> }
  </li>


  </ul>
  
</div>

    <section>
      <p>æœ€è¿‘å·¥ç¨‹é‡Œ <code>Swift</code> å’Œ <code>Objective-C</code> æ··ç¼–çš„åœºæ™¯è¶Šæ¥è¶Šå¤šäº†ï¼Œå¤§å®¶åœ¨ç¼–å†™ <code>Swift</code> ä»£ç æ—¶ï¼Œä¸€èˆ¬éƒ½ä¼šç”¨ <code>didSet</code> æ¥ä½œä¸º <code>Objective-C</code> é‡Œ <code>setter</code> çš„æ›¿ä»£ã€‚ä½†æœ€è¿‘é‡åˆ°å¥½å‡ èµ·ï¼ˆè‡ªå·±å’Œå…¶ä»–åŒäº‹ï¼‰å› ä¸º <code>Swift</code> ä¸­ <code>init</code> é‡Œå¯¹å±æ€§èµ‹å€¼æ²¡æœ‰è§¦å‘ <code>didSet</code>ï¼Œè¿›è€Œå¯¼è‡´ç»“æœä¸ç¬¦åˆé¢„æœŸçš„é—®é¢˜ï¼Œçœ‹æ¥è¿˜æ˜¯å¯¹ <code>Swift</code> ä½¿ç”¨ä¸ç†Ÿç»ƒï¼Œè¿™é‡Œç¨å¾®æ±‡æ€»ä¸‹ã€‚ï¼ˆå¦å¤–ï¼Œæœ«å°¾ä¼šé™„ä¸Š <code>ChatGPT3.5</code> çš„å›ç­”æƒ…å†µï¼‰</p>
<span id="more"></span>

<blockquote>
<p>ç¯å¢ƒ<br>Xcode 15.2<br>Swift 5.9</p>
</blockquote>
<h1 id="æœ‰å…³å±æ€§èµ‹å€¼"><a href="#æœ‰å…³å±æ€§èµ‹å€¼" class="headerlink" title="æœ‰å…³å±æ€§èµ‹å€¼"></a>æœ‰å…³å±æ€§èµ‹å€¼</h1><p>å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ <code>Objective-C</code> é‡Œå¯¹å±æ€§èµ‹å€¼ï¼Œä¸€èˆ¬æœ‰2ç§ï¼Œä¸€ç§æ˜¯<code>ç‚¹æ“ä½œç¬¦</code>ï¼ˆå³ <code>a.x = 1</code>ï¼‰ï¼Œä¸€ç§æ˜¯ç›´æ¥å¯¹æˆå‘˜å˜é‡ <code>ivar</code> èµ‹å€¼ï¼ˆå³ <code>_x = 1</code>ï¼‰ã€‚</p>
<p>å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ <code>@property = ivar + setter + getter</code>ï¼Œè€Œ<code>ç‚¹æ“ä½œç¬¦</code>å®é™…æ˜¯<code>setter/getter</code>çš„è¯­æ³•ç³–ã€‚</p>
<p>è¿›è€Œæœ‰å¸¸è§çš„åˆçº§é¢è¯•é¢˜ï¼š</p>
<blockquote>
<p>åœ¨æ„é€ å‡½æ•°é‡Œï¼Œå¯¹å±æ€§èµ‹å€¼ï¼Œå¯¹ä½¿ç”¨ç‚¹æ“ä½œç¬¦æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ</p>
</blockquote>
<p>ç­”æ¡ˆå¹¶ä¸å›ºå®šï¼ŒåŸºæœ¬è¨€ä¹‹æˆç†å³å¯ï¼Œæ— å¤–ä¹ã€Œå°½é‡å°‘ç”¨ï¼Œå› ä¸ºå¯èƒ½ä¼šåœ¨åˆå§‹åŒ–å®Œæˆä¹‹å‰ï¼Œè§¦å‘ä¸å¿…è¦çš„<code>setter</code>ï¼Œè€Œå…¶ä¸­å¯èƒ½æœ‰ä¸ç¡®å®šçš„é€»è¾‘ï¼Œå¸¦æ¥é£é™©ã€ï¼Œã€Œå¦‚æœèƒ½æ˜ç¡®<code>setter</code>çš„é€»è¾‘ï¼Œå¹¶ä¸”æœŸæœ›å°†éƒ¨åˆ†é€»è¾‘æ”¶æ•›è‡³<code>setter</code>å†…ï¼Œä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œä½†è¦ç•™æ„é£é™©ã€ï¼ŒåŸºæœ¬è¨€ä¹‹æœ‰ç†å³å¯ã€‚</p>
<p>é‚£è¿›å…¥ <code>Swift</code> æ—¶ä»£ï¼Œåœ¨åšä»£ç è¿ç§»ï¼Œæˆ–è€…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¼šä½¿ç”¨ <code>willSet/didSet</code> æ¥ä½œä¸º <code>Objective-C</code> æ—¶ä»£ <code>setter</code> çš„æ›¿ä»£ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Swift</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> myProperty: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Property has been set.&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ <code>Swift</code> é‡Œå¹¶æ²¡æœ‰åŒºåˆ† <code>ç‚¹æ“ä½œç¬¦</code> å’Œ <code>æˆå‘˜å˜é‡ç›´æ¥èµ‹å€¼</code> 2ç§é€»è¾‘ï¼Œå³ä½¿ä¸æ˜¾ç¤ºæ ‡æ³¨ <code>self</code> ä¹Ÿæ˜¯ç›¸åŒçš„é€»è¾‘ï¼Œæ‰€ä»¥å¤§å®¶å€¾å‘äºç»Ÿä¸€å½“åšéƒ½æ˜¯ç±»ä¼¼ <code>Objective-C</code> çš„ <code>ç‚¹æ“ä½œç¬¦</code>ï¼Œå³ <code>setter</code> æ–¹æ³•ã€‚</p>
<p>ç„¶è€Œäº‹å®ä¸Šåœ¨<code>é»˜è®¤å€¼</code>ã€æ„é€ å‡½æ•°ï¼ˆ<code>init</code>ï¼‰ç­‰åœºæ™¯ä¸‹ï¼Œå…¶å®æ˜¯ <strong>ä¸ä¼šè§¦å‘</strong> <code>didSet</code> ç­‰æ–¹æ³•çš„ï¼Œæœ‰äº›åŒå­¦æ˜¯å®Œå…¨ä¸çŸ¥é“ï¼Œæœ‰äº›åŒå­¦æ˜¯çŸ¥é“ï¼Œä½†ç»å¸¸æƒ³ä¸èµ·æ¥ã€‚</p>
<h1 id="è‹¹æœçš„è§£é‡Š"><a href="#è‹¹æœçš„è§£é‡Š" class="headerlink" title="è‹¹æœçš„è§£é‡Š"></a>è‹¹æœçš„è§£é‡Š</h1><p>å…ˆçœ‹çœ‹è‹¹æœå®˜æ–¹çš„æè¿°ï¼Œæœ‰2æ®µæ¥æºï¼Œä¸€æ®µæ˜¯å…³äº<code>å±æ€§/(properties)</code>çš„æè¿°ï¼Œå¦ä¸€æ®µæ˜¯å…³äº<code>æ„é€ å‡½æ•°</code>çš„æè¿°ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://docs.swift.org/swift-book/documentation/the-swift-programming-language/properties/">The Swift Programming Language (5.9.2)&#x2F;Properties</a></p>
<blockquote>
<p>Note<br>The willSet and didSet observers of superclass properties are called when a property is set in a subclass initializer, after the superclass initializer has been called. They arenâ€™t called while a class is setting its own properties, before the superclass initializer has been called.</p>
</blockquote>
<blockquote>
<p>åœ¨è°ƒç”¨<strong>è¶…ç±»åˆå§‹å€¼è®¾å®šé¡¹ä¹‹å</strong>ï¼Œåœ¨å­ç±»æ„é€ å™¨è®¾ç½®å±æ€§æ—¶ï¼Œå°†è°ƒç”¨è¶…ç±»å±æ€§çš„ willSet å’Œ didSet è§‚å¯Ÿè€…ã€‚<br>åœ¨è°ƒç”¨<strong>è¶…ç±»åˆå§‹å€¼è®¾å®šé¡¹ä¹‹å‰</strong>ï¼Œç±»åœ¨è®¾ç½®è‡ªå·±çš„å±æ€§æ—¶ä¸ä¼šè°ƒç”¨å®ƒä»¬ã€‚</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://docs.swift.org/swift-book/documentation/the-swift-programming-language/initialization/#Initializer-Delegation-for-Value-Types">The Swift Programming Language (5.9.2)&#x2F;Initialization</a></p>
<blockquote>
<p>Note<br>When you assign a default value to a stored property, or set its initial value within an initializer, the value of that property is set directly, without calling any property observers.</p>
</blockquote>
<blockquote>
<p>å½“æ‚¨ä¸ºå­˜å‚¨çš„å±æ€§åˆ†é…<strong>é»˜è®¤å€¼</strong>æˆ–åœ¨<strong>æ„é€ å™¨ä¸­</strong>è®¾ç½®å…¶åˆå§‹å€¼æ—¶ï¼Œå°†ç›´æ¥è®¾ç½®è¯¥å±æ€§çš„å€¼ï¼Œè€Œä¸è°ƒç”¨ä»»ä½•å±æ€§è§‚å¯Ÿå™¨ã€‚</p>
</blockquote>
<p>æ€»ç»“ä¸‹æ¥ï¼Œå‡ ä¸ªåŸåˆ™ï¼š</p>
<ol>
<li>é»˜è®¤å€¼ï¼Œä¸è§¦å‘</li>
<li>æ„é€ å™¨ä¸­èµ‹å€¼ï¼Œä¸è§¦å‘ï¼ˆè‡ªèº«å±æ€§ï¼Œéçˆ¶ç±»å±æ€§ï¼‰</li>
<li>æ„é€ å™¨ä¸­èµ‹å€¼ï¼Œåœ¨å­ç±»è°ƒç”¨ <code>super.init</code> ä¹‹åï¼Œå¦‚æœå¯¹çˆ¶ç±»å±æ€§èµ‹å€¼ï¼Œåˆ™è§¦å‘ï¼ˆå¯¹ç¬¬2ç‚¹çš„è¡¥å……ï¼‰</li>
</ol>
<p>é’ˆå¯¹è‹¹æœçš„ç¬¬1æ®µæè¿°ï¼Œä¸Šè¿°ç¬¬3ç‚¹å†™çš„ç®€ç•¥äº†ï¼ŒåŸå› ï¼š</p>
<ol>
<li>åœ¨å­ç±»è°ƒç”¨ <code>super.init</code> ä¹‹å‰ï¼Œå…¶å®æœ¬æ¥å°±ä¸èƒ½å¯¹çˆ¶ç±»å±æ€§èµ‹å€¼ï¼Œä¼šæŠ¥ç¼–è¯‘é”™è¯¯ <code>&#39;self&#39; used in property access &#39;xxx&#39; before &#39;super.init&#39; call</code>ã€‚</li>
<li>è€Œå¦‚æœæ˜¯å¯¹è‡ªå·±çš„å±æ€§èµ‹å€¼ï¼Œå…¶å®æ— è®ºåœ¨ <code>super.init</code> ä¹‹å‰è¿˜æ˜¯ä¹‹åï¼Œå…¶å®éƒ½ä¸ä¼šè§¦å‘ã€‚</li>
</ol>
<p>ä½†å…¶å®å•çº¯ä»è‹¹æœç»™çš„æè¿°ï¼Œå¹¶ä¸èƒ½è¦†ç›–æ‰€æœ‰åœºæ™¯ï¼Œæ¯”å¦‚ï¼š</p>
<ol>
<li>æ„é€ å™¨è°ƒç”¨å¦ä¸€ä¸ªæ–¹æ³•å¯¹å±æ€§èµ‹å€¼ï¼Œæ˜¯å¦è§¦å‘ï¼Ÿ</li>
<li>æ„é€ å™¨ä½¿ç”¨ <code>kvc</code> å¯¹å±æ€§èµ‹å€¼ï¼Œæ˜¯å¦è§¦å‘ï¼Ÿ</li>
<li>æ„é€ å™¨å†…éƒ¨ç”¨ <code>block</code> å¯¹å±æ€§èµ‹å€¼ï¼Œæ˜¯å¦è§¦å‘ï¼Ÿ<blockquote>
<p>å…¶å® 2 å’Œ 3 æœ¬è´¨è¿˜æ˜¯ç¬¬ 1 ä¸ªé—®é¢˜ã€‚</p>
</blockquote>
</li>
</ol>
<h1 id="Swiftçš„å®ç°"><a href="#Swiftçš„å®ç°" class="headerlink" title="Swiftçš„å®ç°"></a>Swiftçš„å®ç°</h1><p>åœ¨è¡¥å……æ‰€æœ‰åŸåˆ™ä¹‹å‰ï¼Œå…ˆé’ˆå¯¹æœ€å°åœºæ™¯ï¼Œå¯¹ <code>Swift</code> çš„å…·ä½“å®ç°è¿›è¡Œç¡®è®¤ã€‚æˆ‘ä»¬é€šè¿‡ç”Ÿæˆ <code>Swift</code> çš„ä¸­é—´è¯­è¨€ï¼ˆ<code>SIL/Swift Intermediate Language</code>ï¼‰ï¼Œæ¥è¿›è¡Œç¡®è®¤ã€‚</p>
<p>å…ˆå†™ä¸€ä¸ªæœ€å°çš„ demoï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Swift</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AA</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> test <span class="operator">=</span> <span class="number">1</span> &#123;</span><br><span class="line">      <span class="keyword">didSet</span> &#123;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">self</span>.updateTest(<span class="number">2</span>)</span><br><span class="line">        test <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateTest</span>(<span class="keyword">_</span> <span class="params">input</span>: <span class="type">Int</span>) &#123;</span><br><span class="line">        test <span class="operator">=</span> input</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå‘½ä»¤ï¼Œå…¶ä¸­ <code>-Onone</code> å‘Šè¯‰ç¼–è¯‘å™¨ä¸åšä»»ä½•ä¼˜åŒ–ï¼Œæ–¹ä¾¿å¯¹æ¯”ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swiftc -emit-silgen -Onone test.swift &gt; test.sil</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆçš„å†…å®¹æœ‰ç‚¹å¤šï¼Œç›´æ¥çœ‹æˆ‘ä»¬å…³å¿ƒçš„éƒ¨åˆ†ï¼Œé‡ç‚¹æ˜¯å¯¹æ¯” <code>init</code> å†…éƒ¨ä¸¤è¡Œä»£ç çš„å·®å¼‚ã€‚</p>
<p>å…ˆæ£€æŸ¥ <code>setter</code> åšäº†ä»€ä¹ˆï¼Œä¼šå‘ç°æ˜¯å…ˆå¯¹å­˜å‚¨çš„æ•°æ®èµ‹å€¼ï¼Œå†è°ƒç”¨ <code>didSet</code> çš„å®é™…é€»è¾‘ã€‚ï¼ˆä»£ç å’Œé™„åŠ æ³¨é‡Šè§ä¸‹æ–¹ï¼‰</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AA.test.setter</span></span><br><span class="line">sil hidden [ossa] @$s8Contents2AAC4testSivs : $@convention(method) (Int, @guaranteed AA) -&gt; () &#123;</span><br><span class="line"><span class="comment">// %0 &quot;value&quot;                                     // users: %6, %2</span></span><br><span class="line"><span class="comment">// %1 &quot;self&quot;                                      // users: %9, %4, %3</span></span><br><span class="line">bb0(%<span class="number">0</span> : $Int, %<span class="number">1</span> : @guaranteed $AA):</span><br><span class="line">  debug_value %<span class="number">0</span> : $Int, let, name <span class="string">&quot;value&quot;</span>, argno <span class="number">1</span>, implicit <span class="comment">// id: %2</span></span><br><span class="line">  debug_value %<span class="number">1</span> : $AA, let, name <span class="string">&quot;self&quot;</span>, argno <span class="number">2</span>, implicit <span class="comment">// id: %3</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™„åŠ æ³¨é‡Šï¼šä»¥ä¸‹3è¡Œæ˜¯å¯¹å­˜å‚¨æ•°æ®çš„èµ‹å€¼ assign</span></span><br><span class="line">  %<span class="number">4</span> = ref_element_addr %<span class="number">1</span> : $AA, #AA.test        <span class="comment">// user: %5</span></span><br><span class="line">  %<span class="number">5</span> = begin_access [modify] [dynamic] %<span class="number">4</span> : $*Int <span class="comment">// users: %7, %6</span></span><br><span class="line">  assign %<span class="number">0</span> to %<span class="number">5</span> : $*Int                         <span class="comment">// id: %6</span></span><br><span class="line">  end_access %<span class="number">5</span> : $*Int                           <span class="comment">// id: %7</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™„åŠ æ³¨é‡Šï¼šè¿™æ—¶å€™æ˜¯è°ƒç”¨ didset</span></span><br><span class="line">  <span class="comment">// function_ref AA.test.didset</span></span><br><span class="line">  %<span class="number">8</span> = function_ref @$s8Contents2AAC4testSivW : $@convention(method) (@guaranteed AA) -&gt; () <span class="comment">// user: %9</span></span><br><span class="line">  %<span class="number">9</span> = apply %<span class="number">8</span>(%<span class="number">1</span>) : $@convention(method) (@guaranteed AA) -&gt; ()</span><br><span class="line">  %<span class="number">10</span> = tuple ()                                  <span class="comment">// user: %11</span></span><br><span class="line">  <span class="keyword">return</span> %<span class="number">10</span> : $()                                <span class="comment">// id: %11</span></span><br><span class="line">&#125; <span class="comment">// end sil function &#x27;$s8Contents2AAC4testSivs&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åæ£€æŸ¥éæ„é€ æ–¹æ³•ï¼Œå¯ä»¥çœ‹å‡ºï¼Œæœ¬è´¨å°±æ˜¯è°ƒç”¨äº† <code>setter</code>ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•é€»è¾‘ã€‚æ‰€ä»¥è¯´æ˜ä¸€ä¸ªé‡è¦çš„äº‹å®ï¼š<strong>æ— è®ºä»ä½•å¤„ï¼ˆåŒ…æ‹¬æ„é€ å‡½æ•°ï¼‰è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œèµ‹å€¼é€»è¾‘éƒ½ä¼šè§¦å‘didSet</strong>ã€‚ï¼ˆä»£ç å’Œé™„åŠ æ³¨é‡Šè§ä¸‹æ–¹ï¼‰</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AA.updateTest(_:)</span></span><br><span class="line">sil hidden [ossa] @$s8Contents2AAC10updateTestyySiF : $@convention(method) (Int, @guaranteed AA) -&gt; () &#123;</span><br><span class="line"><span class="comment">// %0 &quot;input&quot;                                     // users: %5, %2</span></span><br><span class="line"><span class="comment">// %1 &quot;self&quot;                                      // users: %5, %4, %3</span></span><br><span class="line">bb0(%<span class="number">0</span> : $Int, %<span class="number">1</span> : @guaranteed $AA):</span><br><span class="line">  debug_value %<span class="number">0</span> : $Int, let, name <span class="string">&quot;input&quot;</span>, argno <span class="number">1</span> <span class="comment">// id: %2</span></span><br><span class="line">  debug_value %<span class="number">1</span> : $AA, let, name <span class="string">&quot;self&quot;</span>, argno <span class="number">2</span>, implicit <span class="comment">// id: %3</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™„åŠ æ³¨é‡Šï¼šä»¥ä¸‹æ˜¯å¯¹ setter çš„è°ƒç”¨</span></span><br><span class="line">  %<span class="number">4</span> = class_method %<span class="number">1</span> : $AA, #AA.test!setter : (AA) -&gt; (Int) -&gt; (), $@convention(method) (Int, @guaranteed AA) -&gt; () <span class="comment">// user: %5</span></span><br><span class="line">  %<span class="number">5</span> = apply %<span class="number">4</span>(%<span class="number">0</span>, %<span class="number">1</span>) : $@convention(method) (Int, @guaranteed AA) -&gt; ()</span><br><span class="line">  %<span class="number">6</span> = tuple ()                                   <span class="comment">// user: %7</span></span><br><span class="line">  <span class="keyword">return</span> %<span class="number">6</span> : $()                                 <span class="comment">// id: %7</span></span><br><span class="line">&#125; <span class="comment">// end sil function &#x27;$s8Contents2AAC10updateTestyySiF&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æœ€åæ£€æŸ¥ <code>init</code> æ–¹æ³•é‡Œï¼Œé‚£ä¸¤è¡Œçš„é€»è¾‘ï¼Œå°¤å…¶æ˜¯èµ‹å€¼é€»è¾‘ã€‚é¦–å…ˆè°ƒç”¨ <code>updateTest</code> å¾ˆç›´æ¥ï¼Œå°±æ˜¯æ–¹æ³•è°ƒç”¨ã€‚å±æ€§èµ‹å€¼çœ‹ç€å¾ˆçœ¼ç†Ÿï¼Œå¯¹æ¯”ä¸‹ä¼šå‘ç°å’Œ <code>setter</code> é‡Œè°ƒç”¨ <code>didSet</code> å‰çš„ä»£ç å‡ ä¹å®Œå…¨ä¸€æ ·ã€‚æ‰€ä»¥è¯´æ˜ä¸€ä¸ªé‡è¦çš„äº‹å®ï¼š<strong>æ„é€ å™¨é‡Œçš„å±æ€§èµ‹å€¼ï¼Œæ˜¯ç›´æ¥å¯¹å­˜å‚¨è¿›è¡Œèµ‹å€¼ï¼Œå¹¶ä¸æ˜¯è°ƒç”¨çš„setter</strong>ã€‚ ï¼ˆä»£ç å’Œé™„åŠ æ³¨é‡Šè§ä¸‹æ–¹ï¼‰</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AA.init()</span></span><br><span class="line">sil hidden [ossa] @$s8Contents2AACACycfc : $@convention(method) (@owned AA) -&gt; @owned AA &#123;</span><br><span class="line"><span class="comment">// %0 &quot;self&quot;                                      // users: %2, %1</span></span><br><span class="line">bb0(%<span class="number">0</span> : @owned $AA):</span><br><span class="line">  debug_value %<span class="number">0</span> : $AA, let, name <span class="string">&quot;self&quot;</span>, argno <span class="number">1</span>, implicit <span class="comment">// id: %1</span></span><br><span class="line">  %<span class="number">2</span> = mark_uninitialized [rootself] %<span class="number">0</span> : $AA     <span class="comment">// users: %28, %27, %17, %9, %3</span></span><br><span class="line">  %<span class="number">3</span> = begin_borrow %<span class="number">2</span> : $AA                      <span class="comment">// users: %8, %4</span></span><br><span class="line">  %<span class="number">4</span> = ref_element_addr %<span class="number">3</span> : $AA, #AA.test        <span class="comment">// user: %7</span></span><br><span class="line">  <span class="comment">// function_ref variable initialization expression of AA.test</span></span><br><span class="line">  %<span class="number">5</span> = function_ref @$s8Contents2AAC4testSivpfi : $@convention(thin) () -&gt; Int <span class="comment">// user: %6</span></span><br><span class="line">  %<span class="number">6</span> = apply %<span class="number">5</span>() : $@convention(thin) () -&gt; Int  <span class="comment">// user: %7</span></span><br><span class="line">  store %<span class="number">6</span> to [trivial] %<span class="number">4</span> : $*Int                <span class="comment">// id: %7</span></span><br><span class="line">  end_borrow %<span class="number">3</span> : $AA                             <span class="comment">// id: %8</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™„åŠ æ³¨é‡Šï¼šå‡†å¤‡è°ƒç”¨ updateTest</span></span><br><span class="line">  %<span class="number">9</span> = begin_borrow %<span class="number">2</span> : $AA                      <span class="comment">// users: %16, %15, %14</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™„åŠ æ³¨é‡Šï¼šå¯¹ updateTest çš„å…¥å‚ï¼ˆæ•´å‹2ï¼‰åšå‡†å¤‡</span></span><br><span class="line">  %<span class="number">10</span> = integer_literal $Builtin.IntLiteral, <span class="number">2</span>    <span class="comment">// user: %13</span></span><br><span class="line">  %<span class="number">11</span> = metatype $@thin Int.Type                  <span class="comment">// user: %13</span></span><br><span class="line">  <span class="comment">// function_ref Int.init(_builtinIntegerLiteral:)</span></span><br><span class="line">  %<span class="number">12</span> = function_ref @$sSi22_builtinIntegerLiteralSiBI_tcfC : $@convention(method) (Builtin.IntLiteral, @thin Int.Type) -&gt; Int <span class="comment">// user: %13</span></span><br><span class="line">  %<span class="number">13</span> = apply %<span class="number">12</span>(%<span class="number">10</span>, %<span class="number">11</span>) : $@convention(method) (Builtin.IntLiteral, @thin Int.Type) -&gt; Int <span class="comment">// user: %15</span></span><br><span class="line">  %<span class="number">14</span> = class_method %<span class="number">9</span> : $AA, #AA.updateTest : (AA) -&gt; (Int) -&gt; (), $@convention(method) (Int, @guaranteed AA) -&gt; () <span class="comment">// user: %15</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™„åŠ æ³¨é‡Šï¼šè°ƒç”¨ updateTest</span></span><br><span class="line">  %<span class="number">15</span> = apply %<span class="number">14</span>(%<span class="number">13</span>, %<span class="number">9</span>) : $@convention(method) (Int, @guaranteed AA) -&gt; ()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™„åŠ æ³¨é‡Šï¼šç»“æŸè°ƒç”¨ updateTest</span></span><br><span class="line">  end_borrow %<span class="number">9</span> : $AA                             <span class="comment">// id: %16</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™„åŠ æ³¨é‡Šï¼šå‡†å¤‡å±æ€§èµ‹å€¼</span></span><br><span class="line">  %<span class="number">17</span> = begin_borrow %<span class="number">2</span> : $AA                     <span class="comment">// users: %26, %22</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™„åŠ æ³¨é‡Šï¼šå¯¹å‡†å¤‡å±æ€§èµ‹å€¼çš„å³å€¼ï¼ˆæ•´å‹3ï¼‰åšå‡†å¤‡</span></span><br><span class="line">  %<span class="number">18</span> = integer_literal $Builtin.IntLiteral, <span class="number">3</span>    <span class="comment">// user: %21</span></span><br><span class="line">  %<span class="number">19</span> = metatype $@thin Int.Type                  <span class="comment">// user: %21</span></span><br><span class="line">  <span class="comment">// function_ref Int.init(_builtinIntegerLiteral:)</span></span><br><span class="line">  %<span class="number">20</span> = function_ref @$sSi22_builtinIntegerLiteralSiBI_tcfC : $@convention(method) (Builtin.IntLiteral, @thin Int.Type) -&gt; Int <span class="comment">// user: %21</span></span><br><span class="line">  %<span class="number">21</span> = apply %<span class="number">20</span>(%<span class="number">18</span>, %<span class="number">19</span>) : $@convention(method) (Builtin.IntLiteral, @thin Int.Type) -&gt; Int <span class="comment">// user: %24</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™„åŠ æ³¨é‡Šï¼šè·å–å±æ€§å˜é‡åœ°å€ï¼Œå‡†å¤‡èµ‹å€¼ã€‚ç•™æ„è¿™é‡Œæ˜¯ç›´æ¥èµ‹å€¼çš„å­˜å‚¨åœ°å€ï¼Œå¹¶æ²¡æœ‰è°ƒç”¨ setter æ–¹æ³•ã€‚</span></span><br><span class="line">  <span class="comment">// å’Œ setter é‡Œè°ƒç”¨ didSet ä¹‹å‰çš„é€»è¾‘å®Œå…¨ä¸€æ ·</span></span><br><span class="line">  %<span class="number">22</span> = ref_element_addr %<span class="number">17</span> : $AA, #AA.test      <span class="comment">// user: %23</span></span><br><span class="line">  %<span class="number">23</span> = begin_access [modify] [dynamic] %<span class="number">22</span> : $*Int <span class="comment">// users: %25, %24</span></span><br><span class="line">  assign %<span class="number">21</span> to %<span class="number">23</span> : $*Int                       <span class="comment">// id: %24</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™„åŠ å¤‡æ³¨ï¼Œç»“æŸèµ‹å€¼</span></span><br><span class="line">  end_access %<span class="number">23</span> : $*Int                          <span class="comment">// id: %25</span></span><br><span class="line">  end_borrow %<span class="number">17</span> : $AA                            <span class="comment">// id: %26</span></span><br><span class="line">  %<span class="number">27</span> = copy_value %<span class="number">2</span> : $AA                       <span class="comment">// user: %29</span></span><br><span class="line">  destroy_value %<span class="number">2</span> : $AA                          <span class="comment">// id: %28</span></span><br><span class="line">  <span class="keyword">return</span> %<span class="number">27</span> : $AA                                <span class="comment">// id: %29</span></span><br><span class="line">&#125; <span class="comment">// end sil function &#x27;$s8Contents2AACACycfc&#x27;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä»…å¯¹æœ€ç®€å•åœºæ™¯ä¸‹ä¸­é—´ä»£ç åšäº†åˆ†æï¼Œæ„Ÿå…´è¶£çš„åŒå­¦ä»¬ï¼Œå¯ä»¥å¯¹å…¶ä»–å¤æ‚åœºæ™¯ï¼ˆæ¯”å¦‚ç»§æ‰¿ã€<code>block</code>ï¼‰ä¹Ÿè¿›è¡Œåˆ†æç¡®è®¤ã€‚</p>
<p>é€šè¿‡ä»¥ä¸Šå¯¹ä¸­é—´ä»£ç çš„åˆ†æï¼Œå¯ä»¥å¾—å‡º2ä¸ªé‡è¦ç»“è®ºï¼Œ</p>
<ol>
<li>éæ„é€ å‡½æ•°é‡Œçš„å±æ€§èµ‹å€¼ï¼Œä¼šä½¿ç”¨ <code>setter</code> æ–¹æ³•ï¼Œè¿›è€Œè§¦å‘ <code>didSet</code>ï¼Œå¦‚æœæ„é€ å‡½æ•°è°ƒç”¨äº†è¯¥æ–¹æ³•ï¼Œä¹Ÿä¼šè§¦å‘ï¼Œæ²¡æœ‰é€»è¾‘åˆ¤æ–­ã€‚</li>
<li>æ„é€ å‡½æ•°é‡Œå¯¹è‡ªèº«çš„å±æ€§çš„èµ‹å€¼ï¼Œæ˜¯ç›´æ¥å¯¹å­˜å‚¨èµ‹å€¼ï¼Œä¸ä½¿ç”¨ <code>setter</code> æ–¹æ³•ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘ <code>didSet</code>ï¼Œå’Œè‹¹æœå®˜æ–¹æ–‡æ¡£æè¿°ä¸€è‡´ã€‚</li>
</ol>
<h1 id="å„åœºæ™¯éªŒè¯"><a href="#å„åœºæ™¯éªŒè¯" class="headerlink" title="å„åœºæ™¯éªŒè¯"></a>å„åœºæ™¯éªŒè¯</h1><p>åœ¨äº†è§£äº† <code>Swift</code> çš„å®ç°ä¹‹åï¼Œå…¶å®æˆ‘ä»¬ä¸éš¾çŒœæµ‹å‡ºå¯¹äº <code>kvc</code>ã€<code>block</code> ç­‰åœºæ™¯ä¸‹ï¼Œæ˜¯å¦ä¼šè§¦å‘ï¼Œå®é™…éªŒè¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="comment">// ä¸ºæ–¹ä¾¿éªŒè¯ KVC åœºæ™¯ï¼Œç›´æ¥ç»§æ‰¿è‡ª NSObject</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AA</span>: <span class="title class_">NSObject</span> &#123;</span><br><span class="line">    <span class="keyword">@objc</span> <span class="keyword">var</span> test <span class="operator">=</span> <span class="number">1</span> &#123; <span class="comment">// âŒnot åˆå§‹åŒ–ä¸è§¦å‘</span></span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;AA test didSet<span class="subst">\(test)</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">        test <span class="operator">=</span> <span class="number">2</span>            <span class="comment">// âŒnot init é‡Œä¸è§¦å‘</span></span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        <span class="keyword">self</span>.test <span class="operator">=</span> <span class="number">3</span>       <span class="comment">// âŒnot init é‡Œæ˜¾å¼å†™ self ä¹Ÿä¸è§¦å‘</span></span><br><span class="line">        <span class="keyword">self</span>.updateTest(<span class="number">4</span>)  <span class="comment">// âœ…yes init é‡Œè°ƒæ–¹æ³•ï¼Œè§¦å‘</span></span><br><span class="line">        test <span class="operator">=</span> <span class="number">5</span>            <span class="comment">// âŒnot ä¹Ÿä¸è§¦å‘</span></span><br><span class="line">        </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">self</span>.test <span class="operator">=</span> <span class="number">6</span>   <span class="comment">// âœ…yes è§¦å‘</span></span><br><span class="line">        &#125;() <span class="comment">// ç«‹å³æ‰§è¡Œ</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä»¥ä¸‹3ä¸ªç­‰ä»·ï¼Œä½†éœ€è¦ test è¡¥å…… @objc</span></span><br><span class="line">        <span class="keyword">self</span>.setValue(<span class="number">7</span>, forKey: <span class="string">&quot;test&quot;</span>) <span class="comment">// âœ…yes</span></span><br><span class="line">        <span class="comment">// self.setValue(5, forKey: NSExpression(forKeyPath:\AA.test).keyPath) // âœ…yes</span></span><br><span class="line">        <span class="comment">// self.setValue(5, forKey: #keyPath(AA.test)) // âœ…yes å¯ä»¥è§¦å‘</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateTest</span>(<span class="keyword">_</span> <span class="params">input</span>: <span class="type">Int</span>) &#123;</span><br><span class="line">        test <span class="operator">=</span> input <span class="comment">// âœ…yes always</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AAA</span>: <span class="title class_">AA</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> myTest: <span class="type">Int</span> <span class="operator">=</span> <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;AAA test didSet<span class="subst">\(myTest)</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="comment">// test = 6 // âŒnot &#x27;self&#x27; used in property access &#x27;test&#x27; before &#x27;super.init&#x27; call</span></span><br><span class="line">        myTest <span class="operator">=</span> <span class="number">1</span>  <span class="comment">// âŒnot</span></span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        </span><br><span class="line">        myTest <span class="operator">=</span> <span class="number">2</span>  <span class="comment">// âŒnot</span></span><br><span class="line">        test <span class="operator">=</span> <span class="number">9</span>    <span class="comment">// âœ…yes for superclass AA</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aaa <span class="operator">=</span> <span class="type">AAA</span>()</span><br><span class="line">aaa.test <span class="operator">=</span> <span class="number">10</span>   <span class="comment">// âœ…yes è§¦å‘</span></span><br><span class="line">aaa.myTest <span class="operator">=</span> <span class="number">3</span>  <span class="comment">// âœ…yes è§¦å‘</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AA test didSet4</span><br><span class="line">AA test didSet6</span><br><span class="line">AA test didSet7</span><br><span class="line">AA test didSet9</span><br><span class="line">AA test didSet10</span><br><span class="line">AAA test didSet3</span><br></pre></td></tr></table></figure>

<p>æœ€åç¨å¾®å®Œå–„ä¸‹ <code>didSet</code> è§¦å‘&#x2F;ä¸è§¦å‘çš„åœºæ™¯åŸåˆ™ï¼ˆé‡ç‚¹ç•™æ„å‰3æ¡ï¼‰</p>
<ol>
<li>é»˜è®¤å€¼ï¼Œä¸è§¦å‘</li>
<li>æ„é€ å‡½æ•°ä¸­èµ‹å€¼ï¼Œä¸è§¦å‘ï¼ˆä»…é™<strong>è‡ªèº«å±æ€§</strong>ï¼Œéçˆ¶ç±»å±æ€§ï¼‰</li>
<li>æ„é€ å‡½æ•°ä¸­èµ‹å€¼ï¼Œåœ¨å­ç±»è°ƒç”¨ <code>super.init</code> ä¹‹åï¼Œå¦‚æœå¯¹<strong>çˆ¶ç±»å±æ€§</strong>èµ‹å€¼ï¼Œåˆ™<strong>è§¦å‘</strong>ï¼ˆå¯¹ç¬¬2ç‚¹çš„è¡¥å……ï¼‰</li>
<li>æ„é€ å‡½æ•°ä¸­èµ‹å€¼ï¼Œåœ¨å­ç±»è°ƒç”¨ <code>super.init</code> ä¹‹å‰ï¼Œä¸èƒ½å¯¹çˆ¶ç±»å±æ€§èµ‹å€¼ï¼Œç¼–è¯‘æŠ¥é”™</li>
<li>æ„é€ å‡½æ•°ä¸­ï¼Œè°ƒç”¨å…¶ä»–æ–¹æ³•å¯¹å±æ€§èµ‹å€¼ï¼Œè§¦å‘</li>
<li>æ„é€ å‡½æ•°ä¸­ï¼Œä½¿ç”¨ <code>kvc</code> å¯¹å±æ€§èµ‹å€¼ï¼Œè§¦å‘</li>
<li>æ„é€ å‡½æ•°ä¸­ï¼Œä½¿ç”¨ç«‹å³æ‰§è¡Œçš„ <code>block</code> å¯¹å±æ€§èµ‹å€¼ï¼Œè§¦å‘</li>
<li>éæ„é€ å‡½æ•°ï¼Œè§¦å‘ï¼Œå³ä½¿è¢«æ„é€ å‡½æ•°è°ƒç”¨</li>
</ol>
<p>ç®€å•æ€»ç»“ï¼Œå¯¹äºè§‚å¯Ÿå™¨ï¼ˆå¦‚<code>didSet</code>ï¼‰ï¼š<strong>é»˜è®¤å€¼ä¸è§¦å‘ï¼›æ„é€ å‡½æ•°å†…å¯¹è‡ªèº«å±æ€§(éçˆ¶ç±»å±æ€§)ï¼Œç›´æ¥èµ‹å€¼ä¸è§¦å‘ï¼Œé—´æ¥èµ‹å€¼ï¼ˆè°ƒç”¨å…¶ä»–å‡½æ•°ã€<code>block</code>ã€<code>kvc</code>ï¼‰ä¾ç„¶è§¦å‘ï¼›ç»§æ‰¿åœºæ™¯ï¼Œ <code>super.init</code> åå¯¹çˆ¶ç±»å±æ€§å¤åˆ¶ï¼Œä¼šè§¦å‘çˆ¶ç±»å±æ€§çš„ <code>didSet</code>ã€‚</strong></p>
<p>ç®€åŒ–è®°å¿†ï¼Œä¸è§¦å‘ <code>didSet</code> çš„åœºæ™¯ï¼Œå…¶ä»–ä¾‹å¤–åœºæ™¯å‡è§¦å‘ï¼Œæœ€å¥½å†ç‰¹æ®Šè®°ä¸€ä¸‹ç»§æ‰¿åœºæ™¯å¯¹çˆ¶ç±»å±æ€§èµ‹å€¼åè€Œä¼šè§¦å‘çš„æƒ…å†µï¼š</p>
<ol>
<li>é»˜è®¤å€¼</li>
<li>æ„é€ å‡½æ•°å†… <strong>ç›´æ¥</strong> å¯¹ <strong>è‡ªæœ‰</strong> å±æ€§èµ‹å€¼</li>
</ol>
<p>å¦‚æœæˆ‘ä»¬çš„ä»£ç æ¯”è¾ƒå¤šçš„ä½¿ç”¨ <code>didSet/willSet</code>ï¼Œé‚£å¯¹äºæ„é€ å‡½æ•°<code>init</code>å†…éƒ¨çš„è§¦å‘åœºæ™¯ï¼Œä¸€å®šè¦å¤šåŠ å°å¿ƒï¼Œé¿å…è¸©å‘ã€‚</p>
<h1 id="ChatGPT-çš„å›ç­”"><a href="#ChatGPT-çš„å›ç­”" class="headerlink" title="ChatGPT çš„å›ç­”"></a>ChatGPT çš„å›ç­”</h1><p>å› ä¸ºæ‰‹å¤´åªæœ‰ ChatGPT3.5ï¼Œæ²¡æœ‰ ChatGPT4ï¼Œè¿™é‡Œåªæ£€æŸ¥äº† ChatGPT3.5 çš„å›ç­”ã€‚</p>
<p>é’ˆå¯¹ <code>didSet</code> åˆæ¬¡æé—®ï¼š</p>
<ul>
<li>æ„é€ å™¨å†…ç›´æ¥èµ‹å€¼æ˜¯å¦è§¦å‘ï¼Œå›ç­”æ­£ç¡®ã€‚</li>
<li>æ„é€ å™¨å†…ï¼Œå¯¹çˆ¶ç±»å±æ€§èµ‹å€¼æ˜¯å¦è§¦å‘ï¼Œå›ç­”æ­£ç¡®ã€‚</li>
<li>æ„é€ å‡½æ•°å†…è°ƒç”¨å¤–éƒ¨å‡½æ•°èµ‹å€¼æ˜¯å¦è§¦å‘ï¼Œå›ç­”é”™è¯¯ã€‚</li>
<li>æ„é€ å‡½æ•°å†…ç”¨<code>kvc</code>èµ‹å€¼æ˜¯å¦è§¦å‘ï¼Œå›ç­”é”™è¯¯ã€‚</li>
<li>æ„é€ å‡½æ•°å†…ç”¨<code>block</code>èµ‹å€¼æ˜¯å¦è§¦å‘ï¼Œå›ç­”æ­£ç¡®ã€‚ä½†æ˜¯ï¼Œæè¿°è¯´æ˜é‡Œï¼Œå´è¯´æ— è®ºç›´æ¥èµ‹å€¼è¿˜æ˜¯ä½¿ç”¨é—­åŒ…èµ‹å€¼ï¼Œéƒ½ä¼šè§¦å‘ï¼Œåˆ™ä¸æ­£ç¡®ã€‚</li>
</ul>
<p>å½“ç„¶ï¼Œå¦‚æœä½ æå“ä»–ï¼ˆåªæ˜¯å•çº¯è®©ä»–å†ç¡®è®¤ä¸‹ï¼‰ï¼Œä»–ä¼šç«‹é©¬ç»™å‡ºå®Œå…¨ç›¸åçš„ç­”æ¡ˆï¼Œæ­£ç¡®å˜é”™è¯¯ã€é”™è¯¯å˜æ­£ç¡®ğŸ˜‚ã€‚æ‰€ä»¥ï¼Œæ…ç”¨ ChatGPTï¼ˆè‡³å°‘æ…ç”¨3.5ï¼‰æ¥è§£ç­”ä¸€äº›æ¯”è¾ƒå¤æ‚çš„è¯­è¨€ç‰¹æ€§çš„é—®é¢˜ï¼Œä¸€å®šè¦åšå¥½éªŒè¯ã€‚</p>


      

    </section>
    
      <section class='ArticleMeta'>
          <div>
            Published on&nbsp;
            <time datetime="2024-02-01T07:59:28.000Z" itemprop="datePublished">
              2024-02-01
            </time>
          </div>
          
            <div>
              tags: <ul class="TagsInline">
  <li class="meta-text">
  { <a href="/tags/iOS/">iOS</a> }
  </li>

  <li class="meta-text">
  { <a href="/tags/Swift/">Swift</a> }
  </li>

</ul>
            </div>
          
      </section>
    

    <!-- disqus -->
    

    <!-- gitalk -->
    
      <section>
        <div id="gitalk-container"></div>

        <script type="text/javascript">
          var gitalkScript = document.getElementById('gitalk-script');

          if (gitalkScript) {
            gitalkScript.onload = function() {
              /* è¿™é‡Œä¸èƒ½ä¾èµ–ä»»ä½• js é€»è¾‘ï¼Œæ¯”å¦‚ window.locationï¼Œæ˜¯éå¸¸ä¸å‡†ç¡®çš„ï¼Œä¸€åˆ‡æ”¹ç”¨å˜é‡ */
              var gitalk = new Gitalk({
                clientID: '80bb2fb75b60505d4c6d',
                clientSecret: '892409c79a3f576897b2e5bb198b13d73102fc64',
                repo: 'wangqingylw.github.io.comment', // ä»“åº“åœ°å€
                owner: 'wangqingylw', // github ç”¨æˆ·å
                admin: ["wangqingylw"], // github ç”¨æˆ·å
                perPage: 20,
                id: '/2024/02/01/2024-02-Swift-init-didSet/', // æŸ¥æ‰¾ issus çš„æ¡ä»¶
                title: 'Swiftæ„é€ å‡½æ•°(init)ä¸å±æ€§è§‚å¯Ÿå™¨(didSet)',
                body: 'https://www.ckqing.com/2024/02/01/2024-02-Swift-init-didSet/ Swiftæ„é€ å‡½æ•°(init)ä¸å±æ€§è§‚å¯Ÿå™¨(didSet)'
              });
              gitalk.render("gitalk-container");
            };
          }
        </script>
      </section>
    

    
      <script>
        /* è¿™é‡Œæ‰‹å·¥è°ƒä¸€ä¸‹ mermaid çš„ initï¼Œå¦åˆ™æ‡’åŠ è½½åœºæ™¯ä¸ç”Ÿæ•ˆ */
        if (window.mermaid) {
          window.mermaid.init();
        }
      </script>
    
</article>

  
</div>

            <footer>
    <div>Â© 2024 - Wang Qing </div>
    <div>
        <span>
            Powered by <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>
        </span>
        ,
        <span>
            Theme - <a target="_blank" rel="noopener" href="https://github.com/nameoverflow/hexo-theme-icalm">Icalm</a>
        </span>
    </div>
</footer>

        </div>
    </div>
</div>
<!-- Temporarily block singlepager -->
<!-- 
<script src="/js/pager/dist/singlepager.js"></script>
 -->
<!-- <script>
var sp = new Pager('data-pager-shell')
</script> -->
</body>
</html>